# 🚀 로켓 지상 시험 제어 시스템

## 📋 현장 작업 절차

### **1단계: 현장 도착 후 기본 준비**

#### 하드웨어 연결 확인
- [ ] 아두이노 메가와 PC USB 연결 확인
- [ ] 모든 밸브 액추에이터 전원 연결 상태 점검
- [ ] 센서 케이블 연결 상태 확인 (압력, 온도, 유량 센서)
- [ ] 시스템 전원 공급 안정성 확인

#### 소프트웨어 시작
```bash
# 프로그램 실행
npm run dev
```

### **2단계: 시스템 연결 및 초기화**

#### GUI 연결 설정
1. **시리얼 포트 선택**: 헤더에서 COM 포트 선택 (보통 COM3, COM4)
2. **연결**: "Connect" 버튼 클릭
3. **연결 상태 확인**: 헤더 상단 연결 상태 표시등이 녹색으로 변경되는지 확인

#### 초기 상태 점검
- [ ] 모든 밸브가 "CLOSED" 상태인지 확인
- [ ] 센서 데이터가 정상적으로 수신되는지 확인
- [ ] 압력이 안전 범위(850 이하)에 있는지 확인

### **3단계: 시험 준비 및 안전 확인**

#### 압력 시스템 점검
- [ ] **pressureLimit**: 현재 850으로 설정됨 (config.json에서 변경 가능)
- [ ] 압력 센서 정상 작동 확인
- [ ] 응급 셧다운 시스템 테스트

#### 밸브 개별 동작 테스트
각 밸브를 수동으로 열고 닫아서 정상 작동 확인:
- [ ] Ethanol Main (에탄올 주 밸브)
- [ ] N2O Main (아산화질소 주 밸브)  
- [ ] Ethanol Purge (에탄올 퍼지 밸브)
- [ ] N2O Purge (아산화질소 퍼지 밸브)
- [ ] Pressurant Fill (가압제 충전 밸브)
- [ ] System Vent (시스템 벤트 밸브)
- [ ] Igniter Fuel (점화기 연료 밸브)

### **4단계: 시퀀스 실행**

#### 냉간유동 테스트
```
Random Test A/B/C → 기본적인 밸브 동작 순서 테스트
Multi-Open Test → 다중 밸브 동시 제어 테스트
Sequential Mix → 실제 운용과 유사한 순차 동작 테스트
```

#### 온간유동 테스트  
```
Chaos Test → 복잡한 밸브 제어 시나리오 테스트
```

### **5단계: 응급상황 대응**

#### 자동 응급 셧다운 트리거 조건
- 압력이 850을 3회 연속 초과할 경우
- 센서 조건 대기 중 오류 발생
- 밸브 피드백 타임아웃 발생
- 시리얼 통신 오류

#### 수동 응급 셧다운
- **Emergency Shutdown** 시퀀스 클릭
- 실행 순서:
  1. 모든 주 밸브 즉시 닫기 (100ms)
  2. 시스템 벤트 열기 (200ms)
  3. 가압제 충전 밸브 닫기 (100ms)  
  4. 모든 퍼지 밸브 열기 (200ms)
  5. 시스템 안전 상태 확인 (500ms)

## ⚠️ 주요 오류 상황 및 대처법

### **연결 관련 오류**
| 오류 | 원인 | 대처법 |
|------|------|---------|
| 시리얼 포트 연결 실패 | USB 케이블 또는 드라이버 문제 | 케이블 재연결, 다른 COM 포트 시도 |
| 연결 중 데이터 수신 중단 | 통신 불안정 | 연결 해제 후 재연결 |
| 명령 전송 실패 | 하드웨어 통신 오류 | 응급 셧다운 후 수동 점검 |

### **센서 관련 오류**
| 오류 | 원인 | 대처법 |
|------|------|---------|
| 압력 한계 초과 경고 | 시스템 압력 급상승 | 자동 응급 셧다운 실행됨, 원인 파악 후 재시작 |
| 센서 데이터 없음 | 센서 연결 문제 | 센서 케이블 및 전원 확인 |
| 센서 조건 타임아웃 | 목표 값 도달 실패 | 시퀀스 중단, 수동으로 조건 확인 |

### **밸브 제어 오류**
| 오류 | 원인 | 대처법 |
|------|------|---------|
| 밸브 피드백 타임아웃 | 밸브 동작 불량 또는 센서 오류 | 수동으로 밸브 상태 확인, 필요시 응급 셧다운 |
| 밸브 상태 불일치 | 하드웨어와 소프트웨어 상태 차이 | 연결 재설정 또는 수동 확인 |

### **시퀀스 실행 오류**
| 오류 | 원인 | 대처법 |
|------|------|---------|
| 시퀀스 파일 로드 실패 | sequences.json 파일 오류 | 파일 형식 확인, 백업 파일로 복원 |
| 시퀀스 중단 | 단계별 실행 중 오류 발생 | 로그 확인 후 문제 해결, 필요시 응급 셧다운 |

## 🔧 설정 파일 (config.json)

```json
{
  "pressureLimit": 850,           // 압력 한계값 (kPa)
  "valveFeedbackTimeout": 0,      // 밸브 피드백 대기시간 (0=비활성화)
  "maxChartDataPoints": 100       // 차트 최대 데이터 포인트
}
```

## 📊 실시간 모니터링

### 센서 패널
- **압력**: 실시간 압력 값 및 한계 대비 상태
- **온도**: 시스템 온도 모니터링  
- **유량**: 유량 센서 데이터 (L/h 단위)

### 차트 패널
- 실시간 센서 데이터 그래프
- 최근 100개 데이터 포인트 표시
- 시간별 추이 분석 가능

### 터미널 패널
- 모든 시스템 로그 실시간 표시
- 시퀀스 실행 상태 및 오류 메시지
- 최근 500개 로그 유지

## 🚨 안전 수칙

### 필수 안전 점검사항
- [ ] 모든 인원이 안전 거리 확보
- [ ] 응급 셧다운 절차 숙지
- [ ] 수동 밸브 제어 방법 확인
- [ ] 압력 한계 설정 적절성 검토
- [ ] 비상 연락망 준비

### 금지사항
- ❌ 압력 한계 초과 상태에서 시험 진행
- ❌ 센서 오류 상태에서 시퀀스 실행
- ❌ 응급 셧다운 무시하고 작업 진행
- ❌ 밸브 피드백 없이 고압 작업

## 📞 비상 연락처
- **시설 관리**: [연락처 입력]
- **기술 지원**: [연락처 입력]
- **안전 관리**: [연락처 입력]
