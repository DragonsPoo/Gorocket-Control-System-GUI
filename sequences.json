{
  "Pre-Test Purge": [
    { "message": "Open Ethanol Purge", "delay": 0, "commands": ["CMD,Ethanol Purge,Open"] },
    { "message": "Open N2O Purge", "delay": 0, "commands": ["CMD,N2O Purge,Open"] },
    { "message": "Purge lines for 2s", "delay": 2000, "commands": [] },
    { "message": "Close Ethanol Purge", "delay": 0, "commands": ["CMD,Ethanol Purge,Close"] },
    { "message": "Close N2O Purge", "delay": 0, "commands": ["CMD,N2O Purge,Close"] }
  ],
  "Tank Pressurization": [
    { "message": "Ensure System Vent is CLOSED", "delay": 0, "commands": ["CMD,System Vent,Close"] },
    { "message": "Open Pressurant Fill", "delay": 0, "commands": ["CMD,Pressurant Fill,Open"] },
    { "message": "Wait for PT1 ≥ 50 psi (max 100 psi, 60s timeout)", "delay": 0, "commands": [],
      "condition": { "sensor": "pt1", "min": 50, "max": 100, "op": "gte", "timeoutMs": 60000 } },
    { "message": "Stabilize 2s", "delay": 2000, "commands": [] }
  ],
  "Engine Chill & Pre-Flow": [
    { "message": "Crack System Vent", "delay": 0, "commands": ["CMD,System Vent,Open"] },
    { "message": "Open Ethanol Main", "delay": 200, "commands": ["CMD,Ethanol Main,Open"] },
    { "message": "Open N2O Main", "delay": 200, "commands": ["CMD,N2O Main,Open"] },
    { "message": "Wait for PT2 ≤ 20 psi (45s timeout)", "delay": 0, "commands": [],
      "condition": { "sensor": "pt2", "min": 20, "op": "lte", "timeoutMs": 45000 } },
    { "message": "Close System Vent", "delay": 0, "commands": ["CMD,System Vent,Close"] }
  ],
  "Igniter Arm": [
    { "message": "Open Igniter Fuel", "delay": 0, "commands": ["CMD,Igniter Fuel,Open"] },
    { "message": "Verify PT3 ≥ 10 psi (15s timeout)", "delay": 0, "commands": [],
      "condition": { "sensor": "pt3", "min": 10, "op": "gte", "timeoutMs": 15000 } }
  ],
  "Safe Vent": [
    { "message": "Open System Vent", "delay": 0, "commands": ["CMD,System Vent,Open"] },
    { "message": "Close Pressurant Fill", "delay": 0, "commands": ["CMD,Pressurant Fill,Close"] },
    { "message": "Close Ethanol/N2O Main", "delay": 0, "commands": ["CMD,Ethanol Main,Close", "CMD,N2O Main,Close"] }
  ],
  "Emergency Shutdown": [
    { "message": "Close all fills/mains", "delay": 0, "commands": ["CMD,Pressurant Fill,Close","CMD,Ethanol Main,Close","CMD,N2O Main,Close","CMD,Igniter Fuel,Close"] },
    { "message": "Open System Vent", "delay": 0, "commands": ["CMD,System Vent,Open"] }
  ]
}
